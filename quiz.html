<!DOCTYPE HTML>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Penang One Better - Street Food</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
  <link rel="stylesheet" href="styles.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Lilita+One&family=Luckiest+Guy&family=Oswald:wght@200..700&display=swap"
    rel="stylesheet">
</head>

<body class="d-flex flex-column min-vh-100" style="background:#f9f9e6;">
  <nav class="navbar navbar-expand-xl">
    <div class="container-fluid">
      <a class="navbar-brand" href="#"><img src="images/brand-logo.png" height="50" width="180"></a>
      <button class="navbar-toggler order-last" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
        aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav mx-auto">
          <li class="nav-item"><a class="nav-link" aria-current="page" href="#">HOME</a></li>
          <li class="nav-item"><a class="nav-link" href="#">FOOD GALLERY</a></li>
          <li class="nav-item"><a class="nav-link" href="#">FIND A RESTAURANT</a></li>
          <li class="nav-item"><a class="nav-link" href="#">MY FAVOURITE</a></li>
          <li class="nav-item"><a class="nav-link active" href="#">QUIZ</a></li>
        </ul>
        <ul class="navbar-nav">
          <li class="nav-item">
            <a class="account nav-link" href="#">SIGN IN
              <img class="user-icon" src="images/user-logo.png" height="35" width="35">
            </a>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- Start Here -->
  <main class="flex-grow-1">
    <div class="container my-5">
      <div id="quizCard" class="card shadow-lg p-4 mx-auto text-center"
        style="max-width: 700px; border-radius: 20px; background-color:#ffffff;">

        <!-- Carousel Section -->
        <div id="quizCarousel" class="carousel slide mb-4" data-bs-ride="carousel">
          <div class="carousel-inner rounded">
            <div class="carousel-item active">
              <img src="images/quiz_char_kway_teow.png" class="d-block mx-auto" style="width:50%;" alt="Char Kway Teow">
            </div>
            <div class="carousel-item">
              <img src="images/quiz_laksa.png" class="d-block mx-auto" style="width:50%;" alt="Assam Laksa">
            </div>
            <div class="carousel-item">
              <img src="images/quiz_cendol.jpg" class="d-block mx-auto" style="width:50%;" alt="Cendol">
            </div>
          </div>
        </div>


        <h2 class="mb-4">üçú Penang Street Food Quiz</h2>

        <!-- Welcome Section -->
        <div id="welcomeSection">
          <p class="lead">
            Are you ready to test your knowledge of Penang‚Äôs famous street food?
            Challenge yourself and see how many dishes you can recognize!
          </p>
          <button class="btn btn-primary w-100 mt-3" onclick="startQuiz()">Start Quiz</button>
        </div>

        <!-- Quiz Section -->
        <div id="quizSection" style="display:none;">
          <h4 id="questionText" class="mb-3"></h4>
          <img id="foodImage" class="img-fluid rounded mb-3" style="max-height:300px; object-fit:cover;">
          <div id="answerButtons" class="mt-3"></div>
          <p class="mt-2 text-muted" id="progressText"></p>
        </div>

        <!-- Explanation Section (only for wrong answers) -->
        <div id="explainSection" style="display:none;">
          <h4 id="explainTitle"></h4>
          <img id="explainImage" class="img-fluid rounded mb-3" style="max-height:300px; object-fit:cover;">
          <p id="explainText" class="mt-3"></p>
          <p id="yourAnswer" class="fw-bold text-danger"></p>
          <p id="correctAnswer" class="fw-bold text-success"></p>
          <button id="nextBtn" class="btn btn-success w-100 mt-3">Next Question</button>
        </div>

        <!-- Result Section -->
        <div id="resultSection" style="display:none;">
          <h4 id="finalScore"></h4>
          <h5 class="mt-3">üèÜ Rankings</h5>
          <ol id="rankingList" class="text-start"></ol>
          <button class="btn btn-secondary mt-3" onclick="restartQuiz()">Play Again</button>
        </div>
      </div>
    </div>
  </main>
  <!-- End Here -->

  <footer class="footer text-center text-white py-4 mt-auto">
    <div class="container">
      <p class="footer-text">¬© 2025 Penang One Better. All rights reserved.</p>
      <div class="mt-2">
        <a href="#" target="_blank" rel="noopener noreferrer" class="text-white mx-2"><i class="bi bi-facebook"></i></a>
        <a href="#" target="_blank" rel="noopener noreferrer" class="text-white mx-2"><i class="bi bi-whatsapp"></i></a>
        <a href="#" target="_blank" rel="noopener noreferrer" class="text-white mx-2"><i
            class="bi bi-instagram"></i></a>
        <a href="https://github.com/TimLok0319/Street-Food-Introduction-Website" target="_blank"
          rel="noopener noreferrer" class="text-white mx-2"><i class="bi bi-github"></i></a>
      </div>
    </div>
  </footer>

  <!-- Scripts -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

  <!-- Quiz Script -->
  <script>
    const quizData = [{
        question: "What noodles are used in Char Kway Teow?",
        answers: ["Yellow Mee", "Flat Rice Noodles", "Bee Hoon", "Instant Noodles"],
        correct: 1,
        image: "images/char_kway_teow.jpg",
        explanation: "Char Kway Teow uses flat rice noodles stir-fried with prawns, cockles, egg, bean sprouts, and Chinese sausage."
      },
      {
        question: "Penang Assam Laksa is famous for its taste of‚Ä¶",
        answers: ["Coconut milk", "Tamarind (sour)", "Sweet soy sauce", "Curry powder"],
        correct: 1,
        image: "images/assam_laksa.jpg",
        explanation: "Penang Assam Laksa is known for its sour and spicy tamarind-based broth with mackerel fish and fresh herbs."
      },
      {
        question: "Which ingredient makes Cendol green?",
        answers: ["Pandan", "Matcha", "Mint", "Spinach"],
        correct: 0,
        image: "images/cendol.jpg",
        explanation: "The green jelly in Cendol is made from rice flour flavored with pandan juice, giving it its color and aroma."
      }
    ];

    // --- Global state ---
    let currentQuestion = 0;
    let score = 0;
    let answers = []; // store selected answers
    let stage = "welcome"; // "welcome", "quiz", "explain", "result"
    let lastSelected = null;

    // --- Sections ---
    const welcomeSection = $("#welcomeSection");
    const quizSection = $("#quizSection");
    const explainSection = $("#explainSection");
    const resultSection = $("#resultSection");

    // --- Elements ---
    const questionText = $("#questionText");
    const foodImage = $("#foodImage");
    const answerButtons = $("#answerButtons");
    const explainTitle = $("#explainTitle");
    const explainImage = $("#explainImage");
    const explainText = $("#explainText");
    const yourAnswer = $("#yourAnswer");
    const correctAnswer = $("#correctAnswer");
    const finalScore = $("#finalScore");
    const rankingList = $("#rankingList");
    const progressText = $("#progressText");

    // --- Helpers ---
    function hideAll() {
      welcomeSection.hide();
      quizSection.hide();
      explainSection.hide();
      resultSection.hide();
    }

    function saveState() {
      localStorage.setItem("quizState", JSON.stringify({
        currentQuestion,
        score,
        answers,
        stage,
        lastSelected
      }));
    }

    function loadState() {
      const state = JSON.parse(localStorage.getItem("quizState"));
      if (!state) return;
      ({
        currentQuestion,
        score,
        answers,
        stage,
        lastSelected
      } = state);

      if (stage === "quiz") {
        hideAll();
        showQuestion();
        quizSection.show();
      } else if (stage === "explain") {
        hideAll();
        showExplanation();
        explainSection.show();
      } else if (stage === "result") {
        hideAll();
        showResults();
      }
    }

    // --- Flow ---
    function startQuiz() {
      currentQuestion = 0;
      score = 0;
      answers = [];
      stage = "quiz";
      lastSelected = null;

      hideAll();
      showQuestion();
      quizSection.show();
      saveState();
    }

    function showQuestion() {
      const q = quizData[currentQuestion];
      questionText.text(`${currentQuestion + 1}. ${q.question}`);
      foodImage.attr("src", q.image);
      progressText.text(`Question ${currentQuestion + 1} of ${quizData.length}`);

      answerButtons.empty();
      q.answers.forEach((ans, index) => {
        answerButtons.append(`
      <button class="btn btn-outline-primary w-100 mb-2" onclick="submitAnswer(${index})">
        ${ans}
      </button>
    `);
      });
      saveState();
    }

    function submitAnswer(index) {
      const q = quizData[currentQuestion];
      const isCorrect = index === q.correct;

      if (!answers[currentQuestion]) {
        answers[currentQuestion] = {
          selected: index,
          correct: isCorrect
        };
        if (isCorrect) score++;
      }

      if (isCorrect) {
        // ‚úÖ Skip explanation
        currentQuestion++;
        if (currentQuestion < quizData.length) {
          stage = "quiz";
          lastSelected = null;
          showQuestion();
          quizSection.show();
        } else {
          stage = "result";
          showResults();
        }
      } else {
        // ‚ùå Show explanation
        stage = "explain";
        lastSelected = index;
        showExplanation();
      }
      saveState();
    }

    function showExplanation() {
      const q = quizData[currentQuestion];
      const sel = lastSelected;

      hideAll();
      explainTitle.text(q.question);
      explainImage.attr("src", q.image);
      explainText.text(q.explanation);
      yourAnswer.html("Your Answer: " + q.answers[sel] + " ‚ùå");
      correctAnswer.text("Correct Answer: " + q.answers[q.correct]);
      explainSection.show();
      saveState();
    }

    $("#nextBtn").click(() => {
      currentQuestion++;
      lastSelected = null;
      if (currentQuestion < quizData.length) {
        stage = "quiz";
        hideAll();
        showQuestion();
        quizSection.show();
      } else {
        stage = "result";
        showResults();
      }
      saveState();
    });

    function showResults() {
      hideAll();
      finalScore.text(`You got ${score} out of ${quizData.length} üéâ`);
      rankingList.html("<li>Log in to view your history and ranking!</li>"); // placeholder
      resultSection.show();
      saveState();
    }

    function restartQuiz() {
      localStorage.removeItem("quizState");
      currentQuestion = 0;
      score = 0;
      answers = [];
      stage = "welcome";
      lastSelected = null;
      hideAll();
      welcomeSection.show();
    }

    // --- Restore on page load ---
    loadState();
  </script>
</body>

</html>
