<!DOCTYPE HTML>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Penang One Better - Street Food</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity=
     "sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Lilita+One&family=Luckiest+Guy&family=Oswald:wght@200..700&display=swap" rel="stylesheet">
</head>

<body>
    <nav class="navbar navbar-expand-xl">
    <div class="container-fluid">
    <a class="navbar-brand" href="#"><img src="images/brand-logo.png" height="50" width="180"></a>
    <button class="navbar-toggler order-last" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse"  id="navbarNav">
      <ul class="navbar-nav mx-auto">
        <li class="nav-item">
          <a class="nav-link" aria-current="page" href="#">HOME</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#">FOOD GALLERY</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#">FIND A RESTAURANT</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#">MY FAVOURITE</a>
        </li>
        <li class="nav-item">
          <a class="nav-link active" href="#">QUIZ</a>
        </li>
      </ul>

      <ul class="navbar-nav">
        <li class="nav-item">
          <a class="account nav-link" href="#">SIGN IN <img class="user-icon" src="images/user-logo.png" height="35" width="35"></a>
        </li>
      </ul>

    </div>
  </div>
</nav>

<!-- Start Here -->
<div class="container my-5">
  <div id="quizCard" class="card shadow-lg p-4 mx-auto text-center" style="max-width: 600px; border-radius: 20px;">
    <h2 class="mb-4">üçú Penang Street Food Quiz</h2>

    <!-- Login Section -->
    <div id="loginSection">
      <p>Log in to track your progress (or leave blank to play as Guest):</p>
      <input id="email" type="email" class="form-control mb-3" placeholder="Enter your email">
      <button class="btn btn-primary w-100" onclick="startQuiz()">Start Quiz</button>
    </div>

    <!-- Quiz Section -->
    <div id="quizSection" style="display:none;">
      <h4 id="questionText" class="mb-3"></h4>
      <div id="answerButtons" class="mt-3"></div>
      <button id="nextBtn" class="btn btn-success w-100 mt-3">Next</button>
      <p class="mt-2 text-muted" id="progressText"></p>
    </div>

    <!-- Result Section -->
    <div id="resultSection" style="display:none;">
      <h4 id="finalScore"></h4>
      <h5 class="mt-3">üèÜ Rankings</h5>
      <ol id="rankingList" class="text-start"></ol>
      <button class="btn btn-secondary mt-3" onclick="restartQuiz()">Play Again</button>
    </div>
  </div>
</div>


<!-- jQuery + Quiz Script -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
const quizData = [
  {
    question: "What noodles are used in Char Kway Teow?",
    answers: ["Yellow Mee", "Flat Rice Noodles", "Bee Hoon", "Instant Noodles"],
    correct: 1
  },
  {
    question: "Penang Assam Laksa is famous for its taste of‚Ä¶",
    answers: ["Coconut milk", "Tamarind (sour)", "Sweet soy sauce", "Curry powder"],
    correct: 1
  },
  {
    question: "Which ingredient makes Cendol green?",
    answers: ["Pandan", "Matcha", "Mint", "Spinach"],
    correct: 0
  }
];

let currentQuestion = 0;
let score = 0;
let email = "";
let userName = "";

// Elements
const loginSection = $("#loginSection");
const quizSection = $("#quizSection");
const resultSection = $("#resultSection");
const questionText = $("#questionText");
const answerButtons = $("#answerButtons");
const nextBtn = $("#nextBtn");
const finalScore = $("#finalScore");
const rankingList = $("#rankingList");
const progressText = $("#progressText");

function startQuiz() {
  email = $("#email").val().trim();

  if (!email) {
    userName = "Guest";
  } else {
    // Try to fetch previous record
    let users = JSON.parse(localStorage.getItem("penangQuizUsers") || "{}");
    if (!users[email]) {
      // New user, store as record
      users[email] = { name: email.split("@")[0], scores: [] };
      localStorage.setItem("penangQuizUsers", JSON.stringify(users));
    }
    userName = users[email].name;
  }

  loginSection.hide();
  quizSection.show();
  currentQuestion = 0;
  score = 0;
  showQuestion();
}

function showQuestion() {
  let q = quizData[currentQuestion];
  questionText.text((currentQuestion + 1) + ". " + q.question);
  progressText.text(`Question ${currentQuestion + 1} of ${quizData.length}`);

  answerButtons.empty();
  q.answers.forEach((ans, index) => {
    answerButtons.append(`
      <button class="btn btn-outline-primary w-100 mb-2" onclick="selectAnswer(${index})">
        ${ans}
      </button>
    `);
  });
  nextBtn.hide();
}

function selectAnswer(index) {
  if (index === quizData[currentQuestion].correct) {
    score++;
    $(`#answerButtons button:eq(${index})`).removeClass("btn-outline-primary").addClass("btn-success");
  } else {
    $(`#answerButtons button:eq(${index})`).removeClass("btn-outline-primary").addClass("btn-danger");
  }
  $("#answerButtons button").prop("disabled", true);
  nextBtn.show();
}

nextBtn.click(() => {
  currentQuestion++;
  if (currentQuestion < quizData.length) {
    showQuestion();
  } else {
    showResults();
  }
});

function showResults() {
  quizSection.hide();
  resultSection.show();

  finalScore.text(`${userName}, you got ${score} out of ${quizData.length} üéâ`);

  if (userName !== "Guest") {
    // Save score under email
    let users = JSON.parse(localStorage.getItem("penangQuizUsers") || "{}");
    users[email].scores.push(score);
    localStorage.setItem("penangQuizUsers", JSON.stringify(users));

    // Build rankings (highest score of each user)
    let rankings = [];
    for (let userEmail in users) {
      let user = users[userEmail];
      let bestScore = Math.max(...user.scores);
      rankings.push({ name: user.name, score: bestScore });
    }

    rankings.sort((a, b) => b.score - a.score);

    // Show top 5 with medals
    rankingList.empty();
    rankings.slice(0, 5).forEach((r, i) => {
      let medal = "";
      if (i === 0) medal = "ü•á ";
      else if (i === 1) medal = "ü•à ";
      else if (i === 2) medal = "ü•â ";
      rankingList.append(`<li>${medal}${r.name} - ${r.score}/${quizData.length}</li>`);
    });
  } else {
    rankingList.html("<li>Guest scores are not saved. Log in with email to join the rankings!</li>");
  }
}

function restartQuiz() {
  resultSection.hide();
  loginSection.show();
}
</script>

<!-- End Here -->

<footer class="footer text-center text-white py-4">
<div class="container">
  <p class="footer-text">¬© 2025 Penang One Better. All rights reserved.</p>
  <div class="mt-2">
    <a href="#" target="_blank" rel="noopener noreferrer"class="text-white mx-2"><i class="bi bi-facebook"></i></a>
    <a href="#" target="_blank" rel="noopener noreferrer"class="text-white mx-2"><i class="bi bi-whatsapp"></i></a>
    <a href="#" target="_blank" rel="noopener noreferrer"class="text-white mx-2"><i class="bi bi-instagram"></i></a>
    <a href="https://github.com/TimLok0319/Street-Food-Introduction-Website" target="_blank" rel="noopener noreferrer" class="text-white mx-2"><i class="bi bi-github"></i></a>
  </div>
</div>
</footer>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
